# 无锁队列

https://www.jianshu.com/p/b407a306e6ab

https://www.cnblogs.com/alantu2018/p/8469168.html

https://coolshell.cn/articles/8239.html



无锁队列的链表实现

论文：https://www.cs.rochester.edu/u/scott/papers/1996_PODC_queues.pdf

```c
EnQueue(Q, data) //进队列改良版 v2 
{
    n = new node();
    n->value = data;
    n->next = NULL;

    while(TRUE) {
        //先取一下尾指针和尾指针的next
        tail = Q->tail;
        next = tail->next;

        //如果尾指针已经被移动了，则重新开始
        if ( tail != Q->tail ) continue;

        //如果尾指针的 next 不为NULL，则 fetch 全局尾指针到next
        if ( next != NULL ) {
            CAS(Q->tail, tail, next);
            continue;
        }

        //如果加入结点成功，则退出
        if ( CAS(tail->next, next, n) == TRUE ) break;
    }
    CAS(Q->tail, tail, n); //置尾结点
}
```

用数组实现无锁队列

论文：http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.53.8674&rep=rep1&type=pdf